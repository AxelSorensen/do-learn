<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="None" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>DoLearn</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="css/ansi-colours.css" rel="stylesheet" />
        <link href="css/jupyter-cells.css" rel="stylesheet" />
        <link href="css/pandas-dataframe.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "DoLearn: Causal Discovery through Interventions";
        var mkdocs_page_input_path = "index.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> DoLearn
        </a>
        <div class="version">
          v1.0.0
        </div><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Quickstart</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="another.md">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="quickstart/">Quickstart</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Installation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="installation.md">Installation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="defining_causal_model.md">Defining a Causal Model</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="causal_inference.md">Causal Inference</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="structure_learning.md">Structure Learning</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="intervention_design.md">Interventions</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="learning_with_noise.md">Learning with noise</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="optimal_interventions.md">Optimal Interventions</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Docs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="api_reference.md">API Reference</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="contributing.md">Contributing</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">DoLearn</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">DoLearn: Causal Discovery through Interventions</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="dolearn-causal-discovery-through-interventions">DoLearn: Causal Discovery through Interventions</h1>
<h2 id="installation">Installation</h2>
<p>Installing do-learn is easy.</p>
<pre><code class="language-py">pip install do-learn
</code></pre>
<h2 id="defining-causal-model">Defining causal model</h2>
<p>Let's start by instantiating a causal model and providing nodes and edges as arguments.</p>
<pre><code class="language-py">from do_learn import CausalGraph

nodes = ['A', 'B', 'C']
edges = [('A', 'B'), ('B', 'C')]
graph = CausalGraph(nodes,edges)

# Use the display() function to show the graph
graph.display()
</code></pre>
<p><img alt="Image title" src="../assets/output.png" /></p>
<p>We can also generate a random causal model by calling <code>generate_dag()</code> and providing the number of nodes and edge probability. </p>
<pre><code class="language-py">from do_learn import generate_dag
random_graph = generate_dag(num_nodes=5, edge_prob=.8)
random_graph.display()
</code></pre>
<p><img alt="Image title" src="../assets/random_graph.png" /></p>
<p>Now let us sample from our first graph using the <code>sample()</code> function</p>
<pre><code class="language-py">graph.sample()
# Output: {'A': 0, 'B': 0, 'C': 0}
</code></pre>
<p>Since no initial values were given each variable deafults to 0.</p>
<p>We can carry out an intervention on a variable by calling the <code>do()</code> function. It returns a dictionary with 3 keys (pre, post, diff), represeting the values of each variable before and after the intervention and finally the difference between these values.</p>
<pre><code class="language-py">graph.do('A', 1)
# Output: {'pre': {'A': 0, 'B': 0.0, 'C': 0.0},
#          'post': {'A': 1, 'B': 1.0, 'C': 1.0},
#          'diff': {'A': {'B': 1.0, 'C': 1.0}}}
</code></pre>
<p>In our simple example A causes B which causes C, so when A is set to 1 the other two variables change as well.</p>
<h2 id="learning">Learning</h2>
<p>The previous example illustrated sampling from a known causal graph and inferring the results of interventions, however in many cases we are interested in learning an unknown causal graph and using interventions to probe for causal relations.</p>
<h3 id="example-1">Example 1</h3>
<p>Let's start with the simple case of two variables X and Y.
Given two variables, there exist three possible causal structures. Either X causes Y, Y causes X or X and Y are independent.</p>
<p>DoLearn allows us to represent these possible graphs using the <code>EquivalenceClass</code> class. We can plot each one of these graphs using the <code>display_all()</code> function or simply call <code>display_essential_graph()</code> to represent all graphs in one</p>
<pre><code class="language-py">true_graph = CausalGraph(['A','B'], [('A','B')])
possible_graphs = generate_all_dags(2)
equivalence_class = EquivalenceClass(possible_graphs)

equivalence_class.display_essential_graph()
</code></pre>
<p><img alt="Essential Graph" src="../assets/essential_graph.png" /></p>
<p>A dashed undirected edge represent that the edge either goes from X0 to X1, from X1 to X0 or doesn't exist (making X0 and X1 independent) and thereby visualizes all three possible graphs at once.</p>
<p>If we slice the possible graphs to only include 2 of them we get a different essential graph. Now we see a directed dashed edge from X0 to X1, representing that the edge either X0 to X1 or doesn't exist.</p>
<pre><code class="language-py">equivalence_class = EquivalenceClass(possible_graphs[1:3])
equivalence_class.display_essential_graph()
</code></pre>
<p><img alt="Sliced Essential Graph" src="../assets/sliced_essential_graph.png" /></p>
<p>When learning a causal graph we want to reduce the equivalence class of possible graphs by carrying out interventions and ruling out models that aren't consistent with our data. Hopefully with enough interventions we will end up with the true underlying structure.</p>
<p>Let's try learning the true graph in 3-variable setting. First we will define the true causal graph as follows:</p>
<pre><code class="language-py">true_graph = CausalGraph(['A','B','C'], [('A','B'),('A','C'),('B','C')])
possible_graphs = generate_all_dags(3)
equivalence_class = EquivalenceClass(possible_graphs)

equivalence_class.display_essential_graph()
</code></pre>
<p><img alt="Nodes Essential Graph" src="../assets/essential_graph_3_nodes.png" /></p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>

<!--
MkDocs version : 1.6.1
Build Date UTC : 2025-05-19 08:10:50.384998+00:00
-->
